<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RAG 策略配置 - 建账规则助手</title>
    <link rel="stylesheet" href="/static/rag_config.css">
</head>
<body>
    <div class="container">
        <!-- 顶部导航 -->
        <header>
            <h1>🔍 RAG 策略配置</h1>
            <div class="nav-links">
                <a href="/">聊天界面</a>
                <a href="/collaboration">协作会话</a>
            </div>
        </header>

        <!-- 主要内容区域 -->
        <div class="main-content">
            <!-- 左侧：配置面板 -->
            <div class="config-panel">
                <!-- 问题分类测试 -->
                <section class="card">
                    <h2>📝 问题分类测试</h2>
                    <div class="input-group">
                        <textarea id="query-input" placeholder="输入您的问题，例如：什么是建账？如何进行凭证审核？" rows="3"></textarea>
                        <button onclick="classifyQuery()" class="btn-primary">分类问题</button>
                    </div>
                    <div id="classification-result" class="result-box"></div>
                </section>

                <!-- 策略配置 -->
                <section class="card">
                    <h2>⚙️ 检索策略配置</h2>
                    <div class="config-form">
                        <div class="form-group">
                            <label>检索策略</label>
                            <select id="retrieval-strategy">
                                <option value="auto">自动选择（推荐）</option>
                                <option value="vector">向量检索</option>
                                <option value="bm25">BM25 全文检索</option>
                                <option value="hybrid">混合检索</option>
                                <option value="hybrid_rerank">混合检索 + Rerank</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label>返回文档数</label>
                            <input type="number" id="top-k" value="5" min="1" max="20">
                        </div>

                        <div class="form-group" id="weight-config">
                            <label>向量检索权重</label>
                            <input type="range" id="vector-weight" min="0" max="1" step="0.1" value="0.5">
                            <span id="vector-weight-value">0.5</span>

                            <label style="margin-top: 10px;">BM25 检索权重</label>
                            <input type="range" id="bm25-weight" min="0" max="1" step="0.1" value="0.5">
                            <span id="bm25-weight-value">0.5</span>
                        </div>

                        <button onclick="executeRetrieve()" class="btn-primary">执行检索</button>
                    </div>
                </section>

                <!-- 检索结果 -->
                <section class="card">
                    <h2>📊 检索结果</h2>
                    <div id="retrieval-result" class="result-box">
                        <p class="placeholder">输入问题并点击"执行检索"查看结果</p>
                    </div>
                </section>
            </div>

            <!-- 右侧：统计与对比 -->
            <div class="stats-panel">
                <!-- 性能对比 -->
                <section class="card">
                    <h2>📈 检索方法对比</h2>
                    <button onclick="compareMethods()" class="btn-secondary">对比所有方法</button>
                    <div id="compare-result" class="result-box"></div>
                </section>

                <!-- 批量测试 -->
                <section class="card">
                    <h2>🧪 批量测试</h2>
                    <textarea id="batch-queries" placeholder="每行一个问题，例如：&#10;什么是建账？&#10;如何进行凭证审核？&#10;建账的基本原则是什么？" rows="5"></textarea>
                    <button onclick="batchTest()" class="btn-secondary">批量测试</button>
                    <div id="batch-result" class="result-box"></div>
                </section>

                <!-- 统计信息 -->
                <section class="card">
                    <h2>📊 检索统计</h2>
                    <button onclick="getStatistics()" class="btn-secondary">获取统计</button>
                    <div id="statistics-result" class="result-box"></div>
                </section>
            </div>
        </div>
    </div>

    <script src="/static/rag_config.js"></script>
</body>
</html>
